# PKI Services

PKI Services — это проект для управления инфраструктурой открытых ключей (PKI). Реализует создание, управление и отзыв сертификатов, а также управление ключами и списками отзыва сертификатов (CRL). Содержит ролевое управление инфраструктурой. Главная роль - суперадмин. Второстепенные роли – администратор, регистратор.

## Описание проекта

Проект включает несколько компонентов, обеспечивающих работу PKI:

- **Управление сертификатами**: создание корневых и эмитентских сертификатов, управление сроками их действия, отзыв.
- **Управление ключами**: генерация, хранение и удаление закрытых ключей.
- **Списки отзыва (CRL)**: создание и управление списками отозванных сертификатов, приостановка и отзыв.
- **База данных**: хранение информации о сертификатах, запросах на сертификаты и списках отзыва.

Проект написан на C++ с использованием библиотеки OpenSSL для работы с криптографией и SQLite для хранения данных, а также Python и FastAPI для реализации сервера и ролей пользователей.

---

## Установка и настройка

### 1. Установите зависимости
Для работы проекта потребуется:

- **C++ компилятор** (например, GCC или Clang).
- **CMake** для сборки проекта.
- **OpenSSL** для работы с криптографией.
- **SQLite3** для управления базой данных.
- **Python3.9**
- **FastAPI**

Пример установки зависимостей для MacOS:

```bash
sudo brew update
sudo brew install build-essential cmake libssl-dev libsqlite3-dev
pip intall requirements.txt
```

### 2. Сборка проекта
```bash
cd PKI_CPP
mkdir build
cd build
cmake ..
make
```

### 4. Настройка базы данных
Схема базы данных находится в файле db/schema.sql. При первом запуске проекта она автоматически инициализируется – **root.db**

***Схема базы данных***

Проект использует три таблицы для хранения данных:
	1.	root_certs: хранение информации о корневых сертификатах.
	2.	issuing_csr: хранение запросов на сертификаты.
	3.	issuing_certs: хранение выданных сертификатов.

### 5. Структура проекта
```
├── PKI_CPP/
│	├── CA/                             # Директория с сертификатами и ключами
│	│   ├── config/                     # Конфигурационные файлы OpenSSL
│	│   ├── pkcs12/                     # Криптоконтейнеры для конечных пользователей
│	│   ├── root-ca/                    # Корневой центр сертификации
│	│   │   ├── certs/                  # Самоподписанный сертифика КУЦ
│	│   │   └── private/                # Закрытые ключи корневого CA
│	│   ├── issuing-ca/                 # Эмитентский центр сертификации
│	│       ├── certs/                  # Сертификаты эмитентского CA
│	│       ├── crl/                    # CRL эмитентского CA
│	│       ├── csr/                    # Запросы на сертификаты (CSR)
│	│       └── private/                # Закрытые ключи эмитентского CA
│	├── db/                             # База данных
│	│   ├── root.db                     # Файл базы данных
|	│   ├── database.h                  # Хэдерфайл с реализацией класса Database на базе sqlite3
|	│   ├── database.cpp                     
│	│   └── schema.sql                  # Схема базы данных
│	├── utils/                          # Вспомогательные классы
│	│   ├── Menu.hpp                    # Отображение содержимого директорий
│	│   ├── Keys.hpp                    # Работа с закрытыми ключами
│	│   ├── Certificates.hpp            # Работа с сертификатами
│	│   ├── UserFileParser.hpp          # Работа с пользовательскими данными в .txt файлах
│	│   └── CRL.hpp                     # Работа со списками отзыва (CRL)
│	├── database.h                      # Определение класса для работы с базой данных
│	├── database.cpp                    # Реализация методов работы с базой данных
│	├── paths.cpp                       # Файл определения макросов директорий
├── admin.py 							# CLI консоль для администратора
├── superadmin.py						# CLI консоль для супер-админа
├── registrator.py						# CLI консоль для регистратора
├──	server.py							# Локальный сервер для работы системы
├── requirements.txt					# Список необходимых зависимостей для python
└── README.md                       	# Файл документации
```